# Recognizing Instagram Filtered Images with Feature De-stylization

Deep neural networks have been shown to suffer from poor generalization when small perturbations are added (like Gaussian noise), yet little work has been done to evaluate their robustness to more natural image transformations like photo filters. This paper presents a study on how popular pretrained models are affected by commonly used Instagram filters. To this end, we introduce ImageNet-Instagram, a filtered version of ImageNet, where 20 popular Instagram filters are applied to each image in ImageNet. Our analysis suggests that simple structure preserving filters which only alter the global appearance of an image can lead to large differences in the convolutional feature space. To improve generalization, we introduce a lightweight de-stylization module that predicts parameters used for scaling and shifting feature maps to “undo” the changes incurred by filters, inverting the process of style transfer tasks. We further demonstrate the module can be readily plugged into modern CNN architectures together with skip connections. We conduct extensive studies on ImageNet-Instagram, and show quantitatively and qualitatively, that the proposed module, among other things, can effectively improve generalization by simply learning normalization parameters without retraining the entire network, thus recovering the alterations in the feature space caused by the filters.

---
## Paper

Zhe Wu, Zuxuan Wu, Bharat Singh, Larry S. Davis  
[**Recognizing Instagram Filtered Images with Feature De-stylization**](https://arxiv.org/abs/1912.13000)  
*in AAAI 2020 (oral)*

---
## ImageNet-Instagram
We select 20 commonly used Instagram filters and apply them to each image in IMAGENET, the resulting new dataset is named as IMAGENET-INSTAGRAM. IMAGENET-INSTAGRAM is very large, thus we only share the validation set via [**MEGA drive**](https://mega.nz/#!ei5xXShb!372OlQfqqeuCLWw-5pQzfuqR8xDCLwWM0f-1A_6irQE). The transformation method will be released later.

![IMAGENET-INSTAGRAM sample image](https://i.imgur.com/kWVs8Gg.png)  

---
## Framework
We propose DS and generalized DS (gDS) module, as the framework shown below. 

![Image of Framework](https://i.imgur.com/WdOLoSZ.png)  

---
## Experimental Results

We evaluate our proposed DS and gDS on IMAGENET-INSTAGRAM and show quantitatively and qualitatively that the proposed method can effectively improve generalization of the entire network.

### Performance of pretrained ResNet50 on IMAGENET-INSTAGRAM
Performance of ResNet50 pretrained on IMAGENET (Green) and Conv5 feature divergence (Orange). X-axis: Different types of Instagram filters. Left-Y-axis: Top1 accuracy; right-Y-axis: Feature Divergence.

<img src="https://i.imgur.com/lzEETve.png" width="480">

### Effectiveness of DS and gDS

- DS

<img src="https://i.imgur.com/XbhmZ4J.png" width="480">

- gDS

<img src="https://i.imgur.com/VOl19Vf.png" width="480">



### Feature map comparison
Feature maps comparison of ResNet50 and ResNet50+gDS. Two cases from two most challenging Instagram filers are shown. (a) “Lord Kelvin”, (b) “Toaster”. For each example case, we show the original IMAGENET image and its Instagram-filtered version. For each image, we also show the activation feature maps after Conv2, Conv3 and Conv5, generated by ResNet50 and Resnet50+gDS. gDS succesfully transforms the features of filtered images to be close to original images (See the diagonal comparisons).

<img src="https://i.imgur.com/KJxrWFu.png" width="480">

